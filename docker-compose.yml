services:
  backend:
    build:
      context: ./backend
    environment:
      APP_JWT_SECRET: ${APP_JWT_SECRET}
      APP_ADMIN_USERNAME: ${APP_ADMIN_USERNAME}
      APP_ADMIN_PASSWORD: ${APP_ADMIN_PASSWORD}
      APP_PUBLIC_BASE_URL: ${APP_PUBLIC_BASE_URL}
      APP_CORS_ORIGINS: ${APP_CORS_ORIGINS}
      APP_DB_PATH: /data/app.db
      APP_STORAGE_DIR: /data/uploads
      APP_MAX_UPLOAD_BYTES: ${APP_MAX_UPLOAD_BYTES:-1073741824}
      APP_ADMIN_TOKEN_EXPIRES_SECONDS: ${APP_ADMIN_TOKEN_EXPIRES_SECONDS:-86400}
      APP_DOWNLOAD_TOKEN_EXPIRES_SECONDS: ${APP_DOWNLOAD_TOKEN_EXPIRES_SECONDS:-300}
    volumes:
      - ./data:/data
      - ./uploads:/data/uploads
    ports:
      - "8003:8003"
    restart: unless-stopped

  frontend:
    build:
      context: ./frontend
    depends_on:
      - backend
    ports:
      - "5273:5273"
    restart: unless-stopped
